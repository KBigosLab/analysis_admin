
var sql = require('fusion/sql');
var passwd = require('analysis/passwd');

exports.getUser = function(userID) {
  return sql.get('SELECT First,Last FROM accounts WHERE UserID=?',arguments);
}

exports.getUserID = function(email) {
  var res = sql.get('SELECT UserID FROM accounts WHERE Gmail=?',arguments);
  return res.userID;
}

exports.authenticate = function(userID,password) {
  var res = sql.query("SELECT Password FROM accounts WHERE UserID=? LIMIT 1",arguments);
  if (res.length == 1 && res[0].password) {
    return passwd.verify(res[0].password,password);
  } else return false;
}

